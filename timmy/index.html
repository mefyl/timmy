<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>index (timmy.index)</title><link rel="stylesheet" href="../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ timmy</nav><header class="odoc-preamble"><h1 id="timmy"><a href="#timmy" class="anchor"></a>Timmy</h1><p>Timmy is a general-purpose time and calendar library.</p></header><nav class="odoc-toc"><ul><li><a href="#contents">Contents</a></li><li><a href="#rationale-and-relation-to-ptime">Rationale and relation to <code>Ptime</code></a><ul><li><a href="#advanced-calendar-features">Advanced calendar features</a></li><li><a href="#timezone-safety">Timezone safety</a></li><li><a href="#support-for-daylight-saving-timezones">Support for daylight saving timezones</a></li><li><a href="#static-guarantees-of-operation-correctness">Static guarantees of operation correctness</a></li></ul></li><li><a href="#concepts">Concepts</a><ul><li><a href="#time-points-versus-time-representation">Time points versus time representation</a></li><li><a href="#leap-seconds">Leap seconds</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="contents"><a href="#contents" class="anchor"></a>Contents</h2><p>The entry point of this library is the module: <a href="Timmy/index.html"><code>Timmy</code></a>.</p><h2 id="rationale-and-relation-to-ptime"><a href="#rationale-and-relation-to-ptime" class="anchor"></a>Rationale and relation to <code>Ptime</code></h2><p><code>Timmy</code> is built on top of the widely used <code>Ptime</code> library which does most of the underlying heavy lifting. It does not intended as a replacement for it but as an (arguably) higher level, safer and more complete calendar-wise layer, while certainly not being as lean and as battle-tested. Interoperability exists for all relevant objects so both can easily be mixed if needed.</p><p>We describe here the main rationale for such an additional layer.</p><h3 id="advanced-calendar-features"><a href="#advanced-calendar-features" class="anchor"></a>Advanced calendar features</h3><p><code>Ptime</code> made its intention clear to <i>not</i> be a calendar library, and offers limited calendaring support. <code>Timmy</code> offers advanced calendaring features such as computations over dates, weekdays, ISO 8601 weeks, ...</p><h3 id="timezone-safety"><a href="#timezone-safety" class="anchor"></a>Timezone safety</h3><p>While <code>Ptime</code> has timezone support, many operation don't explicitely require a timezone and will default to UTC - eg. <code>Ptime.to_date_time</code> takes the timezone as an optional argument. If an application handles timezone, it is pretty much never correct to omit the timezone in any such conversion call and a single omission can introduce hard to track bugs.</p><p><code>Timmy</code> takes a zero compromise approach on this, all calls converting between dates and points in time have a mandatory timezone parameter.</p><h3 id="support-for-daylight-saving-timezones"><a href="#support-for-daylight-saving-timezones" class="anchor"></a>Support for daylight saving timezones</h3><p><code>Ptime</code> supports only fixed timezone, ie. GMT+X. However many real-life timezone are not a fixed offset because of daylight saving time. Because of this, no <code>Ptime</code> timezone can convert correctly dates both in August and Decemebr in Paris because the first is GMT+2 and the latter GMT+1.</p><p><code>Timmy.Timezone.t</code> supports such varying timezones and offers out-of-the-box implementation for both javascript and Unix.</p><h3 id="static-guarantees-of-operation-correctness"><a href="#static-guarantees-of-operation-correctness" class="anchor"></a>Static guarantees of operation correctness</h3><p>Because <code>Ptime</code> uses tuples to represent dates and daytimes, operations on these objects can fail because there are no guarantees a tuple is a valid date or datetime. <code>Timmy</code> introduces private record types that are guaranteed to be valid dates and daytimes, while still allowing destructuring, thus avoiding potential runtime assertions.</p><pre><code>let at_daytime_ptime (t : Ptime.t) (daytime : Ptime.time) =
  let (date, _) = Ptime.to_date_time t in
  (* Runtime assertion required *)
  Ptime.of_date_time (date, time) |&gt; Option.value_exn

let at_daytime_timmy (t : Timmy.Time.t) (daytime : Timmy.Daytime.t) =
  let date = Timmy.Date.of_time t in
  Timmy.Date.to_time date time</code></pre><h2 id="concepts"><a href="#concepts" class="anchor"></a>Concepts</h2><h3 id="time-points-versus-time-representation"><a href="#time-points-versus-time-representation" class="anchor"></a>Time points versus time representation</h3><h3 id="leap-seconds"><a href="#leap-seconds" class="anchor"></a>Leap seconds</h3></div></body></html>