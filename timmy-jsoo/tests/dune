(executable
 (name test)
 (modules test)
 (modes js)
 (libraries alcotest js_of_ocaml timmy-jsoo)
 (preprocess
  (pps ppx_here js_of_ocaml-ppx)))

(rule
 (alias runtest)
 (enabled_if %{lib-available:js_of_ocaml})
 (action
  (setenv
   TZ
   Europe/Amsterdam
   (run node %{dep:./test.bc.js}))))

(rule
 (alias runtest)
 (deps ../bin/timmy.bc.js)
 (enabled_if %{lib-available:js_of_ocaml})
 (action
  (run node %{dep:./test.mjs})))
