(dirs timmy timmy-clock timmy-jsoo timmy-unix .logistic)

(alias
 (name default)
 (deps
  timmy.opam
  timmy-jsoo.opam
  (alias install)))

(rule
 (target timmy.%{version:timmy}.opam)
 (deps
  (:opam timmy.opam))
 (action
  (with-stdout-to
   %{target}
   (progn
    (cat %{opam})
    (echo
     "url {\n  src: \"git://git@gitlab.routine.co:routine/timmy#%{version:timmy}\"\n}\n")))))

(rule
 (target timmy-jsoo.%{version:timmy-jsoo}.opam)
 (deps
  (:opam timmy-jsoo.opam))
 (action
  (with-stdout-to
   %{target}
   (progn
    (cat %{opam})
    (echo
     "url {\n  src: \"git://git@gitlab.routine.co:routine/timmy#%{version:timmy-jsoo}\"\n}\n")))))

(rule
 (target timmy-unix.%{version:timmy-unix}.opam)
 (deps
  (:opam timmy-unix.opam))
 (action
  (with-stdout-to
   %{target}
   (progn
    (cat %{opam})
    (echo
     "url {\n  src: \"git://git@gitlab.routine.co:routine/timmy#%{version:timmy-unix}\"\n}\n")))))

(documentation
 (package timmy)
 (mld_files "index"))

(rule
 (target dune.extdeps.inc)
 (alias extdeps)
 (mode (promote))
 (action
  (with-stdout-to
   %{target}
   (run
    %{dep:.logistic/dune/extdeps/extdeps.exe}
    generate
    --packages
    timmy,timmy-jsoo,timmy-unix
    --exclude
    schematic,schematic-jsoo))))

(include dune.extdeps.inc)
